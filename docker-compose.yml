name: trascendence
services:
  proxy:
    depends_on:
      - frontend
      - api
    ports:
      - '443:443'
    environment:
      - FRONTEND_PORT
      - API_PORT
    env_file: .env
    extends:
      file: backend/proxy/docker/docker-compose.proxy.yml
      service: proxy

  frontend:
    expose:
      - ${FRONTEND_PORT}
    environment:
      - PORT=${FRONTEND_PORT}
    env_file: .env
    extends:
      file: frontend/docker/docker-compose.frontend.yml
      service: frontend

  api:
    depends_on:
      - auth
      - tournaments
    expose:
      - ${API_PORT}
    environment:
      - PORT=${API_PORT}
      - AUTH_PORT
      - TOURNAMENTS_PORT
    env_file: .env
    extends:
      file: backend/api/docker/docker-compose.api.yml
      service: api

  auth:
    expose:
      - ${AUTH_PORT}
    environment:
      - PORT=${AUTH_PORT}
    env_file: .env
    extends:
      file: backend/auth/docker/docker-compose.auth.yml
      service: auth

  tournaments:
    expose:
      - ${TOURNAMENTS_PORT}
    environment:
      - PORT=${TOURNAMENTS_PORT}
    env_file: .env
    extends:
      file: backend/tournaments/docker/docker-compose.tournaments.yml
      service: tournaments

  ssl-certs:
    extends:
      file: backend/ssl-certs/docker/docker-compose.ssl-certs.yml
      service: ssl-certs

volumes:
  auth_data: null
  tournaments_data: null
